package com.hfwas.devops.tools.api.vulnerability;

import com.hfwas.devops.tools.entity.nvd.NvdResponse;
import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestHeader;
import org.springframework.web.bind.annotation.RequestParam;

@FeignClient(name = "NvdApi", url = "${devops.vulnerability.nvd.url}")
public interface NvdApi {

    @GetMapping("/rest/json/cves/2.0/")
    NvdResponse nvd(@RequestHeader("apiKey") String apiKey,
                    @RequestParam(required = false, defaultValue = "1", value = "startIndex") Integer startIndex,
                    @RequestParam(required = false, defaultValue = "2000", value = "resultsPerPage") Integer resultsPerPage);

    @GetMapping("/rest/json/cvehistory/2.0/")
    NvdResponse nvdChangeHistory(@RequestParam(required = false, value = "changeStartDate") String changeStartDate,
                                 @RequestParam(required = false, value = "changeEndDate") String changeEndDate,
                                 @RequestParam(required = false, value = "cveId") String cveId,
                                 @RequestParam(required = false, value = "eventName") String eventName,
                                 @RequestParam(required = false, value = "resultsPerPage") Integer resultsPerPage,
                                 @RequestParam(required = false, defaultValue = "1", value = "startIndex") Integer startIndex,
                                 @RequestParam(required = false, value = "pageSize", defaultValue = "2000") Integer pageSize);

}
