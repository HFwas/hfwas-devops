package com.hfwas.devops.tools.api.vulnerability;

import com.google.gson.JsonArray;
import com.google.gson.JsonObject;
import com.hfwas.devops.tools.entity.cwe.CweInfo;
import com.hfwas.devops.tools.entity.cwe.CweVersion;
import com.hfwas.devops.tools.entity.cwe.CweWeakness;
import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestParam;

import java.util.List;

/**
 * @author houfei
 * @package com.hfwas.devops.tools.api.vulnerability
 * @date 2025/1/8
 */
@FeignClient(name = "CweApi", url = "${devops.vulnerability.cwe.url}")
public interface CweApi {

    @GetMapping("/api/v1/cwe/version")
    CweVersion getVersion();

    @GetMapping("/api/v1/cwe/{cweId}")
    List<CweInfo> cweInfo(@PathVariable("cweId") String cweId);

    @GetMapping("/api/v1/cwe/weakness/{cweId}")
    CweWeakness weakness(@PathVariable("cweId") String cweId);

    @GetMapping("/api/v1/cwe/category/{cweId}")
    JsonObject category(@PathVariable("cweId") String cweId);

    @GetMapping("/api/v1/cwe/view/{cweId}")
    JsonObject view(@PathVariable("cweId") String cweId);

    @GetMapping("/api/v1/cwe/{cweId}/parents")
    JsonObject parents(@PathVariable("cweId") String cweId, @RequestParam("view") Integer view);

    @GetMapping("/api/v1/cwe/{cweId}/descendants")
    JsonArray descendants(@PathVariable("cweId") String cweId, @RequestParam("view") Integer view);

    @GetMapping("/api/v1/cwe/{cweId}/children")
    JsonArray children(@PathVariable("cweId") String cweId, @RequestParam("view") Integer view);

    @GetMapping("/api/v1/cwe/{cweId}/ancestors")
    JsonArray ancestors(@PathVariable("cweId") String cweId, @RequestParam("view") Integer view);

}
