package cn.hfwas.devops.tools.api.vulnerability;

import cn.hfwas.devops.tools.entity.nvd.NvdResponse;
import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;

import java.util.List;

@FeignClient(name = "NvdApi", url = "devops.vulnerability.nvd.url:https://services.nvd.nist.gov")
public interface NvdApi {

    @GetMapping("/rest/json/cves/2.0")
    NvdResponse nvd(@RequestParam(required = false) String cpeName, @RequestParam(required = false) String cveId,
                    @RequestParam(required = false) String cveTag, @RequestParam(required = false) String cvssV2Metrics,
                    @RequestParam(required = false) String cvssV2Severity, @RequestParam(required = false) String cvssV3Metrics,
                    @RequestParam(required = false) String cvssV3Severity, @RequestParam(required = false) String cvssV4Metrics,
                    @RequestParam(required = false) String cvssV4Severity, @RequestParam(required = false) String cweId,
                    @RequestParam(required = false) String hasCertAlerts, @RequestParam(required = false) String hasCertNotes,
                    @RequestParam(required = false) String hasKev, @RequestParam(required = false) String hasOval,
                    @RequestParam(required = false) String isVulnerable, @RequestParam(required = false) String keywordExactMatch,
                    @RequestParam(required = false) String keywordSearch, @RequestParam(required = false) String lastModStartDate,
                    @RequestParam(required = false) String lastModEndDate, @RequestParam(required = false) String noRejected,
                    @RequestParam(required = false) String pubStartDate, @RequestParam(required = false) String pubEndDate,
                    @RequestParam(required = false) String resultsPerPage, @RequestParam(required = false) String startIndex,
                    @RequestParam(required = false) String sourceIdentifier, @RequestParam(required = false) String versionEnd,
                    @RequestParam(required = false) String versionEndType, @RequestParam(required = false) String versionStart,
                    @RequestParam(required = false) String versionStartType, @RequestParam(required = false) String virtualMatchString);

    @GetMapping("/rest/json/cvehistory/2.0")
    NvdResponse nvdChangeHistory(@RequestParam(required = false) String changeStartDate, @RequestParam(required = false) String changeEndDate,
                                 @RequestParam(required = false) String cveId, @RequestParam(required = false) String eventName,
                                 @RequestParam(required = false) Integer resultsPerPage, @RequestParam(required = false) Integer startIndex,
                                 @RequestParam(required = false) Integer pageSize);

}
